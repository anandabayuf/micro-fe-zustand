{"version":3,"file":"static/js/399.22fb6636.chunk.js","mappings":"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","sources":["utils/encryptUtils.ts","services/authService/auth.api.ts","features/Login/components/Form/index.tsx","features/Login/index.tsx","pages/Login/index.tsx","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js"],"sourcesContent":["import forge from 'node-forge';\r\n\r\nexport const encryptPassword = (password: string, publicKey: string) => {\r\n\tconst publicKeyBinary = forge.util.decode64(publicKey);\r\n\tconst publicKeyPem = forge.pki.publicKeyToPem(\r\n\t\tforge.pki.publicKeyFromAsn1(forge.asn1.fromDer(publicKeyBinary))\r\n\t);\r\n\r\n\tconst key = forge.pki.publicKeyFromPem(publicKeyPem);\r\n\tconst encrypted = forge.util.encode64(\r\n\t\tkey.encrypt(password, 'RSAES-PKCS1-V1_5')\r\n\t);\r\n\treturn encrypted;\r\n};\r\n\r\ntype TUserData = {\r\n\tusername: string;\r\n\tpassword: string;\r\n};\r\n\r\nexport const encryptAuth = (\r\n\tuserData: TUserData,\r\n\tpublicKey: string\r\n): string | void => {\r\n\ttry {\r\n\t\tconst encryptedPassword = encryptPassword(userData.password, publicKey);\r\n\t\tconst authNaked = `${userData.username}:${encryptedPassword}`;\r\n\t\treturn btoa(authNaked);\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t}\r\n};\r\n","import { TBaseQuery, TBaseQueryArgs, TFetchResponse } from '@/services/types';\r\nimport {\r\n\tremoveAccessToken,\r\n\tsetAccessToken,\r\n\tsetPublicKey,\r\n} from '@/services/authService/slice';\r\nimport apiSlice from '../secured.api';\r\nimport { RootState } from '@/combinedReducers';\r\nimport { DEFAULT_IAM_URL } from '@/services/constants';\r\nimport { HTTPMethod } from '@/services/enums';\r\nimport {\r\n\tTPublicKeyApi,\r\n\tTUserInfoJwtPayload,\r\n\tTUserData,\r\n} from '@/services/authService/types';\r\nimport { encryptAuth } from '@/utils/encryptUtils';\r\n\r\nexport const getPublicKey = async (\r\n\tbaseQuery: (arg: TBaseQueryArgs) => TBaseQuery<TPublicKeyApi>\r\n) => {\r\n\tconst response = await baseQuery({\r\n\t\turl: `${DEFAULT_IAM_URL}/public/publickey`,\r\n\t\tmethod: HTTPMethod.GET,\r\n\t});\r\n\r\n\tif (!response.data) return { error: response.error };\r\n\treturn { data: response.data };\r\n};\r\n\r\nexport const authApi = apiSlice.injectEndpoints({\r\n\tendpoints: (builder) => ({\r\n\t\tlogin: builder.mutation({\r\n\t\t\tqueryFn: async (\r\n\t\t\t\tpayload: TUserData,\r\n\t\t\t\tapi,\r\n\t\t\t\t_,\r\n\t\t\t\tbaseQuery: (\r\n\t\t\t\t\targ: TBaseQueryArgs\r\n\t\t\t\t) => TBaseQuery<TUserInfoJwtPayload | any>\r\n\t\t\t) => {\r\n\t\t\t\tconst { auth } = api.getState() as RootState;\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tlet publicKey = auth.publicKey;\r\n\r\n\t\t\t\tif (!publicKey) {\r\n\t\t\t\t\tpublicKey = (await getPublicKey(baseQuery)).data.content\r\n\t\t\t\t\t\t.publicKey;\r\n\t\t\t\t\tif (!publicKey) return { error: 'Fail to get public key' };\r\n\t\t\t\t\tapi.dispatch(setPublicKey(publicKey || null));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst encryptedAuth = await encryptAuth(\r\n\t\t\t\t\t{ username: payload.username, password: payload.password },\r\n\t\t\t\t\tpublicKey as string\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconst response = await baseQuery({\r\n\t\t\t\t\turl: '/login',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAuthorization: `basic ${encryptedAuth}`,\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!response.data) return { error: response.error };\r\n\r\n\t\t\t\tconst accessToken = response.meta.response?.headers.get(\r\n\t\t\t\t\t'access_token'\r\n\t\t\t\t) as string;\r\n\r\n\t\t\t\tapi.dispatch(setAccessToken(accessToken));\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: { accessToken },\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t}),\r\n\t\tlogout: builder.mutation({\r\n\t\t\tqueryFn: async (\r\n\t\t\t\tparams,\r\n\t\t\t\tapi,\r\n\t\t\t\t_,\r\n\t\t\t\tbaseQuery: (\r\n\t\t\t\t\targ: TBaseQueryArgs\r\n\t\t\t\t) => TBaseQuery<TFetchResponse<null>>\r\n\t\t\t) => {\r\n\t\t\t\tconst response = await baseQuery({\r\n\t\t\t\t\turl: '/secured/logout',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!response.data) return { error: response.error };\r\n\r\n\t\t\t\tapi.dispatch(removeAccessToken());\r\n\t\t\t\treturn { data: response.data };\r\n\t\t\t},\r\n\t\t}),\r\n\t}),\r\n});\r\n\r\nexport const { useLoginMutation, useLogoutMutation } = authApi;\r\n","import React from 'react';\nimport { Button, Form, Input } from 'antd';\nimport { useNavigate } from 'react-router-dom';\nimport { setCookie } from '../../../../utils/cookieUtils';\nimport { useLoginMutation } from '@/services/authService/auth.api';\nimport { TUserData } from '@/services/authService/types';\n\nconst LoginForm: React.FC = () => {\n\tconst navigate = useNavigate();\n\n\t// const handleLogin = (value: any) => {\n\t// \tif (!value) return;\n\n\t// \tconst token =\n\t// \t\t'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c';\n\n\t// \tsetUser(value);\n\t// \tsetToken(token);\n\n\t// \tsetCookie('user', JSON.stringify(value));\n\t// \tsetCookie('token', token);\n\n\t// \tnavigate('/', { replace: true });\n\t// };\n\n\tconst [login] = useLoginMutation();\n\n\tconst onFinish = async (userData: TUserData) => {\n\t\ttry {\n\t\t\tawait login(userData).unwrap();\n\t\t\tnavigate('/home');\n\t\t} catch (error: unknown) {\n\t\t\tconsole.error(error);\n\t\t}\n\t};\n\n\treturn (\n\t\t<Form\n\t\t\tlayout=\"vertical\"\n\t\t\tonFinish={onFinish}\n\t\t>\n\t\t\t<Form.Item\n\t\t\t\tname=\"username\"\n\t\t\t\tlabel=\"Username\"\n\t\t\t>\n\t\t\t\t<Input placeholder=\"input your username\" />\n\t\t\t</Form.Item>\n\n\t\t\t<Form.Item\n\t\t\t\tname=\"password\"\n\t\t\t\tlabel=\"Password\"\n\t\t\t>\n\t\t\t\t<Input.Password placeholder=\"input your password\" />\n\t\t\t</Form.Item>\n\n\t\t\t<Button\n\t\t\t\thtmlType=\"submit\"\n\t\t\t\ttype=\"primary\"\n\t\t\t>\n\t\t\t\tLogin\n\t\t\t</Button>\n\t\t</Form>\n\t);\n};\n\nexport default LoginForm;\n","import React from 'react';\nimport LoginForm from './components/Form';\n\nconst Login: React.FC = () => {\n\treturn <LoginForm />;\n};\n\nexport default Login;\n","import React from 'react';\nimport AppFooter from 'submodule/AppFooter';\nimport AppHeader from 'submodule/AppHeader';\nimport Login from '../../features/Login';\n\nconst LoginPage: React.FC = () => {\n\treturn (\n\t\t<div>\n\t\t\t<AppHeader />\n\t\t\t<Login />\n\t\t\t<AppFooter />\n\t\t</div>\n\t);\n};\n\nexport default LoginPage;\n","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}"],"names":["encryptAuth","userData","publicKey","encryptedPassword","password","publicKeyBinary","forge","decode64","publicKeyPem","publicKeyToPem","publicKeyFromAsn1","fromDer","key","publicKeyFromPem","encode64","encrypt","encryptPassword","authNaked","concat","username","btoa","error","console","getPublicKey","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","baseQuery","response","wrap","_context","prev","next","url","DEFAULT_IAM_URL","method","HTTPMethod","GET","sent","data","abrupt","stop","_x","apply","arguments","authApi","apiSlice","injectEndpoints","endpoints","builder","login","mutation","queryFn","_queryFn","_callee2","payload","api","_","_response$meta$respon","_ref2","auth","encryptedAuth","accessToken","_context2","getState","content","dispatch","setPublicKey","headers","Authorization","meta","get","setAccessToken","_x2","_x3","_x4","_x5","logout","_queryFn2","_callee3","params","_context3","removeAccessToken","_x6","_x7","_x8","_x9","useLoginMutation","useLogoutMutation","navigate","useNavigate","_useLoginMutation","_slicedToArray","onFinish","unwrap","t0","_jsxs","Form","layout","children","_jsx","Item","name","label","Input","placeholder","Password","Button","htmlType","type","LoginForm","AppHeader","Login","AppFooter","_arrayWithHoles","arr","Array","isArray","_nonIterableRest","TypeError","i","arrayWithHoles","r","l","t","Symbol","iterator","e","n","u","a","f","o","call","Object","done","push","value","length","unsupportedIterableToArray","nonIterableRest"],"sourceRoot":""}