"use strict";(self.webpackChunkcontainer=self.webpackChunkcontainer||[]).push([[399],{6399:function(r,e,n){n.r(e),n.d(e,{default:function(){return F}});n(8416);var t=n(7199),a=n.n(t),u=n(7196),o=n.n(u),c=n(4165),i=n(5861),s=n(9439),l=n(8412),p=n(2083),f=n(8124),d=n(5395),h=n(3076),m=n(7846),b=n(9237),y=n.n(b),v=function(r,e){try{var n=function(r,e){var n=y().util.decode64(e),t=y().pki.publicKeyToPem(y().pki.publicKeyFromAsn1(y().asn1.fromDer(n))),a=y().pki.publicKeyFromPem(t);return y().util.encode64(a.encrypt(r,"RSAES-PKCS1-V1_5"))}(r.password,e),t="".concat(r.username,":").concat(n);return btoa(t)}catch(a){console.error(a)}},x=function(){var r=(0,i.Z)((0,c.Z)().mark((function r(e){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e({url:"".concat(h.z9,"/public/publickey"),method:m.Ik.GET});case 2:if((n=r.sent).data){r.next=5;break}return r.abrupt("return",{error:n.error});case 5:return r.abrupt("return",{data:n.data});case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),k=d.Z.injectEndpoints({endpoints:function(r){return{login:r.mutation({queryFn:function(){var r=(0,i.Z)((0,c.Z)().mark((function r(e,n,t,a){var u,o,i,s,l,p,d;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=n.getState(),i=o.auth,s=i.publicKey){r.next=9;break}return r.next=5,x(a);case 5:if(s=r.sent.data.content.publicKey){r.next=8;break}return r.abrupt("return",{error:"Fail to get public key"});case 8:n.dispatch((0,f.Dh)(s||null));case 9:return r.next=11,v({username:e.username,password:e.password},s);case 11:return l=r.sent,r.next=14,a({url:"/login",method:"POST",headers:{Authorization:"basic ".concat(l)}});case 14:if((p=r.sent).data){r.next=17;break}return r.abrupt("return",{error:p.error});case 17:return d=null===(u=p.meta.response)||void 0===u?void 0:u.headers.get("access_token"),n.dispatch((0,f.M8)(d)),r.abrupt("return",{data:{accessToken:d}});case 20:case"end":return r.stop()}}),r)})));return function(e,n,t,a){return r.apply(this,arguments)}}()}),logout:r.mutation({queryFn:function(){var r=(0,i.Z)((0,c.Z)().mark((function r(e,n,t,a){var u;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a({url:"/secured/logout",method:"POST"});case 2:if((u=r.sent).data){r.next=5;break}return r.abrupt("return",{error:u.error});case 5:return n.dispatch((0,f.yL)()),r.abrupt("return",{data:u.data});case 7:case"end":return r.stop()}}),r)})));return function(e,n,t,a){return r.apply(this,arguments)}}()})}}}),w=k.useLoginMutation,Z=(k.useLogoutMutation,n(184)),j=function(){var r=(0,p.useNavigate)(),e=w(),n=(0,s.Z)(e,1)[0],t=function(){var e=(0,i.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t).unwrap();case 3:r("/home"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r){return e.apply(this,arguments)}}();return(0,Z.jsxs)(l.Form,{layout:"vertical",onFinish:t,children:[(0,Z.jsx)(l.Form.Item,{name:"username",label:"Username",children:(0,Z.jsx)(l.Input,{placeholder:"input your username"})}),(0,Z.jsx)(l.Form.Item,{name:"password",label:"Password",children:(0,Z.jsx)(l.Input.Password,{placeholder:"input your password"})}),(0,Z.jsx)(l.Button,{htmlType:"submit",type:"primary",children:"Login"})]})},g=function(){return(0,Z.jsx)(j,{})},F=function(){return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(o(),{}),(0,Z.jsx)(g,{}),(0,Z.jsx)(a(),{})]})}},3878:function(r,e,n){function t(r){if(Array.isArray(r))return r}n.d(e,{Z:function(){return t}})},5267:function(r,e,n){function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(e,{Z:function(){return t}})},9439:function(r,e,n){n.d(e,{Z:function(){return o}});var t=n(3878);var a=n(181),u=n(5267);function o(r,e){return(0,t.Z)(r)||function(r,e){var n=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,u,o,c=[],i=!0,s=!1;try{if(u=(n=n.call(r)).next,0===e){if(Object(n)!==n)return;i=!1}else for(;!(i=(t=u.call(n)).done)&&(c.push(t.value),c.length!==e);i=!0);}catch(r){s=!0,a=r}finally{try{if(!i&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return c}}(r,e)||(0,a.Z)(r,e)||(0,u.Z)()}}}]);
//# sourceMappingURL=399.22fb6636.chunk.js.map